<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>onBoarding</title>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"
        integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

    <link href="https://cdn.jsdelivr.net/gh/sun-typeface/SUITE/fonts/static/woff2/SUITE.css" rel="stylesheet">
    <link rel="stylesheet" href="./onboarding.css">
    <link rel="icon" href="./img/face.png" type="image/x-icon">
</head>

<body>
    <!-- 첫번째 팝업 -->
    <div class="container">
        <div class="popup" id="popup1">
            <img class="logo" src="./img/logo.png">
            <div class="survey-num">
                <!-- <div class="survey survey-num1">1</div> -->
                <div class="line line1"></div>
                <div class="line line2"></div>
                <!-- <div class="survey survey-num2">2</div> -->
            </div>

            <p class="question">감정소비를 한 적이 있나요?</p>
            <div class="content-wrapper">
                <input type="button" class="q-box question-num1">
                <input type="button" class="q-box question-num2">
            </div>
            <p class="p-ex">* 감정소비란? 스트레스 해소를 위해 소비하는 것</p>
            <input type="button" class="btn submit-btn" value="다음으로" disabled onclick="nextBtn(2)">
        </div>


        <!-- 두번째 팝업-->
        <div class="popup" id="popup2">
            <img class="logo" src="./img/logo.png">
            <div class="survey-num">
                <!-- <div class="survey survey-num1">1</div> -->
                <div class="line line1"></div>
                <div class="line line2"></div>
                <!-- <div class="survey survey-num2">2</div> -->
            </div>

            <p class="question">감정소비를 하는 가장 큰 이유는?</p>
            <div class="content-wrapper">
                <input type="button" class="q-box q-box2" value="직장 스트레스" onclick="qBox2(1);">
                <input type="button" class="q-box q-box2" value="인간관계 스트레스" onclick="qBox2(2);">
                <input type="button" class="q-box q-box2" value="금전 스트레스" onclick="qBox2(3);">
                <input type="button" class="q-box q-box2" value="가사, 육아 스트레스" onclick="qBox2(4);">
                <input type="button" class="q-box q-box2" value="취업 스트레스" onclick="qBox2(5);">
                <input type="button" class="q-box q-box2" value="연애, 결혼 스트레스" onclick="qBox2(6);">
            </div>
            <input type="button" class="btn submit-btn" value="다음으로" disabled onclick="nextBtn(3)">
        </div>



        <!-- 세번째 팝업-->
        <div class="popup" id="popup3">
            <img class="logo" src="./img/logo.png">

            <div class="survey-result" id="firstAnswer"></div>
            <div class="survey-result">다양한 분들이 참여한 설문 결과를 통해 감정소비 경험을 살펴보세요.</div>
            <div class="content-wrapper">
                <div class="survey-result" style="margin-top:30px;">Q. 감정소비를 한 적이 있나요?</div>
                <div class="yes-no-idx">
                    <div class="idx-box idx-box1"></div><div class="idx-name" style="font-size:12px;">있다</div>
                    <div class="idx-box idx-box1"></div><div class="idx-name" style="font-size:12px;">없다</div>
            </div>
                <div class="pie-wrapper">
                    <div class="pie-chart pie-chart1"><span class="center">93.8%</span></div>
                    <div class="month-price">감정소비에 사용하는 월 평균 비용<br>
                        월 151,891원</div>
                    </div>
                    

                   
                </div>
            <input type="button" class="btn next result-btn" value="다음으로" onclick="nextBtn(4)">
        </div>

        <!-- 네번째 팝업-->
        <div class="popup" id="popup4">
            <img class="logo" src="./img/logo.png">

            <!-- <p class="question">세번째</p> -->

            <div class="content-wrapper">

                <div class="graphWrap">
                    <div class="graph">
                        <div id="item1" class="p-1"><span class="percentage">32.3%</span></div>
                        <div id="item2" class="p-2"><span class="percentage">22.8%</span></div>
                        <div id="item3" class="p-3"><span class="percentage">15.2%</span></div>
                        <div id="item4" class="p-4"></span><span class="percentage">12.6%</span></div>
                        <div id="item5" class="p-5"><span class="percentage">10.3%</span></div>
                        <div id="item6" class="p-6"></span><span class="percentage">5.1%</span></div>
                    </div>
                </div>
                <div class="idx-wrapper">
                    <div class="idx-box idx-box1"></div><div class="idx-name">직장</div>
                    <div class="idx-box idx-box2"></div><div class="idx-name">인간관계</div>
                    <div class="idx-box idx-box3"></div><div class="idx-name">금전</div>
                    <div class="idx-box idx-box4"></div><div class="idx-name">가사,육아</div>
                    <div class="idx-box idx-box5"></div><div class="idx-name">취업</div>
                    <div class="idx-box idx-box6"></div><div class="idx-name">연애,결혼</div>
                </div>
                <div class="idx-wrapper"><span style="margin-right:5px;">자료</span>벼룩시장 구인구직</div>
                <div class="idx-wrapper" style="margin-top:5px;"><span style="margin-right:5px;">대상</span>성인 남녀 1096명</div>
            </div>
            <input type="button" class="btn move-btn next" value="차곡차곡 시작하기" onclick="location.href='./main.html'">
        </div>
    </div>

</body>

<script>
    const btn = $('.submit-btn');
    let answer = [];
    let answer2 = [];

    // 다음 버튼을 누르면 버튼 css가 초기화 되도록(disabled 처리)
    $('.submit-btn').on('click', function () {
        btn.attr('disabled');
        btn.removeClass('next');
        btn.css('background-color', 'rgb(204, 204, 204)')
        $('.line1').css('background-color', '#c1c1c1');
        $('.line2').css('background-color', '#FADEDA');


    })
    // .q-box 클릭 이벤트
    $('.q-box').on('focus', function () {
        btn.removeAttr('disabled');
        btn.addClass('next');
        btn.css('background-color', '#FADEDA')
        console.log($('.submit-btn').prop('disabled'));
    })


    // 수정한 코드
    $(document).on('click', function (event) {
        const clickedElement = $(event.target);

        console.log(clickedElement)
        // 만약 클릭된 요소가 .q-box가 아니고, submit-btn이 아니면
        if (!clickedElement.hasClass('q-box') && !clickedElement.hasClass('submit-btn')) {
            // submit-btn을 disabled 처리하고 스타일 초기화
            btn.attr('disabled', 'disabled');
            btn.removeClass('next');
            btn.css('background-color', 'rgb(204, 204, 204)')
            console.log($('.submit-btn').prop('disabled'));
        }
    });


    // .q-box을 마지막으로 클릭한 값을 받아오기 위한 클릭이벤트
    $('.question-num1').on('click', function () {
        answer.push('yes');
        console.log(answer);
    })
    $('.question-num2').on('click', function () {
        answer.push('no');
        console.log(answer);
    })

    function qBox2(num) {
        if (num == 1) {
            answer2.push(1);
        } else if (num == 2) {
            answer2.push(2);
        } else if (num == 3) {
            answer2.push(3);
        } else if (num == 4) {
            answer2.push(4);
        } else if (num == 5) {
            answer2.push(5);
        } else {
            answer2.push(6);
        }
    }


    // 팝업 이벤트
    function nextBtn(nextPopupNumber) {
        // 현재 팝업 숨기기
        $('.popup:visible').css('display', 'none');

        // 다음 팝업 표시
        const nextPopup = $('#popup' + nextPopupNumber);
        nextPopup.css('display', 'block');

        // const hi =$('.q-box2:clicked').val();

        if (answer[answer.length - 1] == 'yes') {
            console.log(answer2[answer2.length - 1])
            if (answer2[answer2.length - 1] == 1) {
                $('#firstAnswer').text('직장 스트레스로 감정소비를 한 경험이 있으시군요!')
            } else if (answer2[answer2.length - 1] == 2) {
                $('#firstAnswer').text('인간관계 스트레스로 로감정소비를 한 경험이 있으시군요!')
            } else if (answer2[answer2.length - 1] == 3) {
                $('#firstAnswer').text('금전 스트레스로 감정소비를 한 경험이 있으시군요!')
            } else if (answer2[answer2.length - 1] == 4) {
                $('#firstAnswer').text('가사, 육아 스트레스로 감정소비를 한 경험이 있으시군요!')
            } else if (answer2[answer2.length - 1] == 5) {
                $('#firstAnswer').text('취업 스트레스로 감정소비를 한 경험이 있으시군요!')
            } else {
                $('#firstAnswer').text('연애, 결혼 스트레스로 감정소비를 한 경험이 있으시군요!')
            }
        } else {
            $('#firstAnswer').text('감정소비 경험이 없으시군요!')
            // console.log(answer[answer.length - 1])
            $('#popup2').css('display', 'none');
            $('#popup3').css('display', 'block');
        }
        if (nextPopupNumber == 4) {
            $('#popup3').css('display', 'none');
        }

    }

    // $(window).ready(function () {
    //     draw(93, '.pie-chart', 'red');

    // });



    // $('.result-btn').click(function () {
    //     draw(93, '.pie-chart', 'red');
    // });


    // function draw(max, classname, colorname) {
    //     var i = 1;
    //     var func1 = setInterval(function () {
    //         if (i < max) {
    //             color1(i, classname, colorname);
    //             i++;
    //         } else {
    //             clearInterval(func1);
    //         }
    //     }, 10);
    // }
    // function color1(i, classname, colorname) {
    //     $(classname).css({
    //         "background": "conic-gradient(" + colorname + " 0% " + i + "%, #cccccc " + i + "% 100%)"
    //     });
    // }
    $('.btn').click(function () {
        drawWithTransition(93, '.pie-chart', 'red');
    });

    function drawWithTransition(max, classname, colorname) {
        var i = 1;
        var func1 = setInterval(function () {
            if (i < max) {
                colorWithTransition(i, classname, colorname);
                i++;
            } else {
                clearInterval(func1);
            }
        }, 10);
    }

    function colorWithTransition(i, classname, colorname) {
        $(classname).css({
            "background": "conic-gradient(" + colorname + " 0% " + i + "%, #cccccc " + i + "% 100%)",
            "transition": "background 0.3s"  // 트랜지션 속성 추가
        });
    }


</script>

</html>